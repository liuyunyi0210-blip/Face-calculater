# API 錯誤診斷指南

## 🔍 常見錯誤訊息及原因

### 1. "API 金鑰設定錯誤或無效"

**可能原因**：
- ❌ GitHub Secrets 中未設置 `GEMINI_API_KEY`
- ❌ API 金鑰格式錯誤
- ❌ API 金鑰已被撤銷或無效
- ❌ 構建時環境變數未正確注入

**解決方案**：
1. 檢查 GitHub Secrets：
   - 前往：Settings → Secrets and variables → Actions
   - 確認 `GEMINI_API_KEY` 存在且正確
2. 重新申請 API 金鑰（如果已撤銷）：
   - 前往：https://ai.google.dev/
   - 創建新的 API 金鑰
3. 重新部署：
   - 推送代碼觸發重新部署
   - 確保構建時環境變數正確注入

### 2. "API 使用配額已達上限" ⭐

**可能原因**：
- ✅ **免費配額已用完**（最常見）
- ✅ 達到每分鐘/每小時請求限制
- ✅ 達到每日配額上限

**解決方案**：
1. **檢查配額狀態**：
   - 前往：https://ai.google.dev/
   - 查看 API 使用情況和配額
2. **等待配額重置**：
   - 免費配額通常會定期重置（每日/每月）
   - 等待配額重置後再試
3. **升級到付費方案**（如果需要）：
   - 在 Google Cloud Console 升級
   - 獲得更高的配額限制

### 3. "網路連線錯誤"

**可能原因**：
- 網絡連線不穩定
- 防火牆阻擋
- API 服務暫時不可用

**解決方案**：
1. 檢查網絡連線
2. 稍後再試
3. 檢查瀏覽器主控台是否有詳細錯誤

### 4. "API 服務暫時不可用"

**可能原因**：
- Google Gemini API 服務維護
- 服務暫時中斷

**解決方案**：
- 等待服務恢復
- 查看 Google AI Studio 狀態頁面

## 📊 如何區分錯誤類型

### 如果一開始能正常使用，後來出現錯誤：

1. **"API 使用配額已達上限"** 
   - ✅ 最可能是配額問題
   - 解決：等待配額重置或檢查配額狀態

2. **"API 金鑰設定錯誤"**
   - ❌ 可能是 API 金鑰被撤銷
   - 解決：重新申請 API 金鑰並更新 GitHub Secrets

3. **"網路連線錯誤"**
   - ⚠️ 可能是暫時性問題
   - 解決：稍後再試

## 🔧 診斷步驟

### 步驟 1：查看錯誤訊息
- 打開瀏覽器主控台（F12 → Console）
- 查看完整的錯誤訊息
- 根據錯誤訊息判斷問題類型

### 步驟 2：檢查 API 配額
1. 前往：https://ai.google.dev/
2. 登入您的帳號
3. 查看 API 使用情況
4. 確認配額是否已用完

### 步驟 3：檢查 GitHub Secrets
1. 前往：Settings → Secrets → Actions
2. 確認 `GEMINI_API_KEY` 存在
3. 如果不存在或錯誤，重新設置

### 步驟 4：檢查部署狀態
1. 前往：Actions
2. 查看最新的部署
3. 確認構建成功
4. 查看構建日誌中是否有警告

## 💡 免費配額說明

Google Gemini API 免費配額：
- **通常有每日/每月請求限制**
- **配額會定期重置**
- **可以在 Google AI Studio 查看配額狀態**

如果配額用完：
- 等待配額重置（通常是每日或每月）
- 或升級到付費方案獲得更高配額

## ✅ 快速檢查清單

遇到錯誤時，按順序檢查：

- [ ] 錯誤訊息是什麼？（配額/金鑰/網絡）
- [ ] API 配額是否用完？（前往 Google AI Studio 檢查）
- [ ] GitHub Secrets 中的 API 金鑰是否正確？
- [ ] 網站是否已重新部署？
- [ ] 網絡連線是否正常？

## 🎯 總結

**如果正常使用後出現「環境變數配置錯誤」**：

1. **首先檢查是否為配額問題**：
   - 前往 Google AI Studio 查看配額狀態
   - 如果配額用完，等待重置

2. **如果不是配額問題**：
   - 檢查 API 金鑰是否有效
   - 確認 GitHub Secrets 設定正確
   - 重新部署網站

3. **查看詳細錯誤訊息**：
   - 打開瀏覽器主控台
   - 查看完整的錯誤訊息
   - 根據錯誤類型採取相應措施

